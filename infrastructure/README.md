# "Инфраструктура".

## Для запуска инфраструктуры необходимо:
Отредактировать под свои значения файлы:
* key.json
* main.tf в ресурсе backend "s3" значение bucket = "ХХХХ"
* variables.tf все переменные с "ХХХХ"
* Выполнить импорт переменных export AWS_ACCESS_KEY_ID="ХХХХ" && export AWS_SECRET_ACCESS_KEY="ХХХХ"

## Назначение файлов:
### gitlab.tf.
* Создает две ВМ с именами "gitlab.kor-iv.ru" и "runner.kor-iv.ru" на базе CentOS 7 для CI/CD.
### key.json
* Ключи для доступа к YC.
### main.tf
* Задает используемый провайдер "yandex-cloud/yandex" версии 0.75 или выше.
* Задает использование ханилища "storage.yandexcloud.net" для состояния инфраструктуры. 
* Задает использование файла "key.json" для передачи ключей для YC
## meta.txt
* Используется для передачи публичного ключа и пользователя в ВМ.
### monitoring.tf
* Создает ВМ с именем "monitoring.kor-iv.ru" на базе CentOS 7 для мониторинга.
### mysql.tf
* Создает две ВМ с именами "db01.kor-iv.ru" и "db02.kor-iv.ru" на базе CentOS 7 для кластера mysql.
### network.tf
* Создает "yandex_vpc_network" сеть с именем "net"
* Создает подсеть в зоне доступности "ru-central1-b" с адресами "192.168.1.0/24"
* Создает подсеть в зоне доступности "ru-central1-a" с адресами "192.168.101.0/24"
* Создает таблицу маршрутизации "yandex_vpc_route_table" для доступа к внешним ресурсам ВМ без внешнего IP адреса.
### nginx.tf
* Создает ВМ с именем "kor-iv.ru" на базе CentOS 7 для обратного прокси.
### output.tf
* Задает вывод в консоль внешних и внутренних адресов ВМ, зон доступности, наименование текущего workspace.
### variables.tf
* Задает переменную "yandex_cloud_id" от YC.
* Задает переменную "yandex_folder_id" от YC.
* Задает переменную "centos-7-base" идентификатор образа ОС для ВМ.
* Задает переменную "my_domain" для имени домена.
* Задает переменную "yc_token". По умолчанию не заполнен.
### wordpress.tf
* Создает ВМ с именем "app.kor-iv.ru" на базе CentOS 7 для wordpress.

 
